<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta name="description" content="Angel Cosmeticos Pagina voltada para Beleza das mulheres">
    <meta name="keywords"
        content="#AngelCosmeticos,#Consultora Mary kay, #ProdutoMary Mary Kay, #Grasiely Machado, @#AngelCosmeticos, #maquiagem, #beleza, #limpeza de pele, #ConsultoraMaryKay, Angel Cosmeticos, Beleza, Maquiagem, Produtos">
    <meta name="description"
        content="Conheça Angel Cosméticos com a consultora Grasiely Machado. Produtos de alta qualidade, maquiagem e skincare Mary Kay.">
    <!-- Previne cache excessivo em navegadores anônimos -->
    <meta http-equiv="Cache-Control" content="no-store">
    <meta http-equiv="Pragma" content="no-cache">

    <!-- Controla como a página é renderizada em sessões anônimas -->
    <meta http-equiv="Expires" content="0">

    <meta name="description"
        content="#AngelCosmeticos,#Consultora Mary kay, #ProdutoMary Mary Kay, #Grasiely Machado, @#AngelCosmeticos, #maquiagem, #beleza, #limpeza de pele, #ConsultoraMaryKay, Angel Cosmeticos">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Grasiely da Silva Machado">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Android -->
    <link rel="icon" sizes="192x192" href="android-icon.png">
    <link rel="icon" href="favicon.png" type="image/jpeg">
    <link rel="icon" href="/assets/img/ChamdaSite.jpeg" alt="Angel Cosmeticos" type="image/x-icon">
    <title>Angel Cosméticos | Consultora Grasiely Machado MK</title>
    <link rel="stylesheet" href="https://unpkg.com/ionicons@7.1.0/dist/css/ionicons.min.css">
    <link rel="stylesheet" href="/assets/css/cadastro.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/rodape.css">
    <link rel="stylesheet" href="/assets/css/teste.css">
    <link rel="stylesheet" href="https://unpkg.com/ionicons@7.1.0/dist/css/ionicons.min.css">
    <meta name="google-site-verification" content="p9mFqdpGS6hjijzxKVGAhM-3X6lsOLqhGLST1TZE1OI" />
</head>
<body>
   

    <div class="corpo-categorias carrinho-compras">

        <h2>Carrinho de Compras</h2>
        <table >
            <thead>
                <tr>
                    <th>Imagem</th>
                    <th>Produto</th>
                    <th>Tamanho</th>
                    <th>Quantidade</th>
                    <th>Preço Unitário</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody id="tabelaCarrinho">
                <!-- Os produtos serão adicionados dinamicamente aqui -->

            </tbody>
        </table>

        <div class="valor-total">
            <table>
                <thead>
                    <tr>
                        <td>Sub-Total</td>
                        <td id="subtotal-geral">R$ 0.00</td>
                    </tr>
                    <tr>
                        <td>Frete</td>
                        <td id="frete">R$ 0.00</td>
                    </tr>
                    <tr>
                        <td>Total</td>
                        <td id="total-geral">R$ 0.00</td>
                    </tr>
                </thead>
            </table>

        </div>

    
    <script src="/assets/js/carrinho.js" defer></script>
    <script src="/assets/js/carrinhopoduto.js"></script>
  
</body>
</html>


document.addEventListener("DOMContentLoaded", function () {
    const produtos = [
        {
            id: 1, // Alterado de produtoId para id
            nome: "Blusa de frio manga longa meletinho",
            precos: {
                P: 450,
                M: 500,
                G: 550,
                GG: 600,
                XG: 650
            },
            descricao: "Produto de alta qualidade, feito com material de primeira linha.",
            imagens: [
                "/assets/img/galeria-1.jpg",
                "/assets/img/galeria-2.jpg",
                "/assets/img/galeria-3.jpg",
                "/assets/img/galeria-4.jpg",
                "/assets/img/galeria-5.jpg"
            ]
        },
        {
            id: 2, // Alterado de produtoId para id
            nome: "Blusa de frio manga longa meletinho",
            precos: {
                P: 450,
                M: 500,
                G: 550,
                GG: 600,
                XG: 650
            },
            descricao: "Produto de alta qualidade, feito com material de primeira linha.",
            imagens: [
                "/assets/img/galeria-1.jpg",
                "/assets/img/galeria-2.jpg",
                "/assets/img/galeria-3.jpg",
                "/assets/img/galeria-4.jpg",
                "/assets/img/galeria-5.jpg"
            ]
        },
        {
            id: 3, // Alterado de produtoId para id
            nome: "Blusa de frio manga longa meletinho",
            precos: {
                P: 450,
                M: 500,
                G: 550,
                GG: 600,
                XG: 650
            },
            descricao: "Produto de alta qualidade, feito com material de primeira linha.",
            imagens: [
                "/assets/img/galeria-1.jpg",
                "/assets/img/galeria-2.jpg",
                "/assets/img/galeria-3.jpg",
                "/assets/img/galeria-4.jpg",
                "/assets/img/galeria-5.jpg"
            ]
        },
        {
            id: 4, // Alterado de produtoId para id
            nome: "Blusa de frio manga longa meletinho",
            precos: {
                P: 450,
                M: 500,
                G: 550,
                GG: 600,
                XG: 650
            },
            descricao: "Produto de alta qualidade, feito com material de primeira linha.",
            imagens: [
                "/assets/img/galeria-1.jpg",
                "/assets/img/galeria-2.jpg",
                "/assets/img/galeria-3.jpg",
                "/assets/img/galeria-4.jpg",
                "/assets/img/galeria-5.jpg"
            ]
        },
        {
            id: 5, // Alterado de produtoId para id
            nome: "Blusa de frio manga longa meletinho",
            precos: {
                P: 450,
                M: 500,
                G: 550,
                GG: 600,
                XG: 650
            },
            descricao: "Produto de alta qualidade, feito com material de primeira linha.",
            imagens: [
                "/assets/img/galeria-1.jpg",
                "/assets/img/galeria-2.jpg",
                "/assets/img/galeria-3.jpg",
                "/assets/img/galeria-4.jpg",
                "/assets/img/galeria-5.jpg"
            ]
        },
        {
            id: 6, // Alterado de produtoId para id
            nome: "Blusa de frio manga longa meletinho",
            precos: {
                P: 450,
                M: 500,
                G: 550,
                GG: 600,
                XG: 650
            },
            descricao: "Produto de alta qualidade, feito com material de primeira linha.",
            imagens: [
                "/assets/img/galeria-1.jpg",
                "/assets/img/galeria-2.jpg",
                "/assets/img/galeria-3.jpg",
                "/assets/img/galeria-4.jpg",
                "/assets/img/galeria-5.jpg"
            ]
        }
    ];

    const tbody = document.querySelector("tbody");

    imagens.forEach((imgSrc) => {
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        const th = document.createElement("th"); // Corrigido aqui
        const img = document.createElement("img");
        img.src = imgSrc;
        img.alt = "produtoMiniatura"; // Corrigido o texto no alt
        th.appendChild(img);
        td.appendChild(img);
        tr.appendChild(td);
        tbody.appendChild(tr);
    });

    const container = document.querySelector(".corpo-categorias .linha");

    produtos.forEach(produto => {
        const produtoDiv = document.createElement("div");
        produtoDiv.className = "col-2";

        // HTML do produto
        produtoDiv.innerHTML = `
            <img class="imagemProduto" src="${produto.imagens[0]}" alt="${produto.id}" id="produtoImg">
            <div class="img-linha">
                ${produto.imagens.map(imagem => `
                    <div class="img-col">
                        <img src="${imagem}" alt="${produto.nome}" width="100%" class="produtoMiniatura">
                    </div>
                `).join('')}
            </div>
            <p>${produto.nome}</p>
            <h1>Compre com desconto</h1>
            <form action="" method="post" id="formAdicionarCarrinho">
                <select name="Tamanho" id="Tamanho">
                    <option value="">Tamanho</option>
                    ${Object.keys(produto.precos).map(tamanho => `
                        <option value="${tamanho}">${tamanho}</option>
                    `).join('')}
                </select>
                <input type="number" name="quantidade" id="quantidade" value="1" min="1">
                <button type="submit" class="btn">Adicionar ao Carrinho</button>
            </form>
            <div id="feedback"></div>
            <h3>Descrição do Produto:</h3>
            <p>${produto.descricao}</p>
        `;

        container.appendChild(produtoDiv);

        // Troca de imagem principal ao clicar na miniatura
        const produtoImg = produtoDiv.querySelector("#produtoImg");
        const miniaturas = produtoDiv.querySelectorAll(".produtoMiniatura");

        miniaturas.forEach(miniatura => {
            miniatura.addEventListener("click", function () {
                produtoImg.src = this.src; // Troca a imagem principal
            });
        });

        // Adicionar produto ao carrinho ao clicar no botão
        const formCarrinho = produtoDiv.querySelector("#formAdicionarCarrinho");
        formCarrinho.addEventListener("submit", function (event) {
            event.preventDefault(); // Impede o envio do formulário

            // Captura os dados do produto
            const tamanho = produtoDiv.querySelector("#Tamanho").value;
            const quantidade = parseInt(produtoDiv.querySelector("#quantidade").value);
            const nomeProduto = produto.nome;
            const preco = produto.precos[tamanho];
            const imagemProduto = produtoImg.src;
            const produtoId = produto.id; // Alterado de produto.produtoId para produto.id

            // Validação do tamanho e quantidade
            if (!tamanho) {
                alert("Por favor, selecione um tamanho.");
                return;
            }
            if (quantidade < 1) {
                alert("Por favor, insira uma quantidade válida.");
                return;
            }

            // Cria o objeto do produto
            const produtoCarrinho = {
                produtoId: produtoId, // Alterado de produto.produtoId para produto.id
                nome: nomeProduto,
                preco,
                tamanho,
                quantidade,
                imagem: imagemProduto,
                total: preco * quantidade
            };

            // Recupera o carrinho do localStorage
            const carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];

            // Verifica se o produto já está no carrinho pelo ID e tamanho
            const produtoExistente = carrinho.find(item => item.produtoId === produtoCarrinho.produtoId && item.tamanho === produtoCarrinho.tamanho);

            if (produtoExistente) {
                // Incrementa a quantidade e atualiza o total
                produtoExistente.quantidade += produtoCarrinho.quantidade;
                produtoExistente.total = produtoExistente.preco * produtoExistente.quantidade;
            } else {
                // Adiciona o produto ao carrinho
                carrinho.push(produtoCarrinho);
            }

            // Salva o carrinho no localStorage
            localStorage.setItem("carrinho", JSON.stringify(carrinho));

            // Redireciona para a página do carrinho
            alert("Produto adicionado ao carrinho!");
            window.location.href = "/assets/html/carrinho.html";
        });
    });
});
